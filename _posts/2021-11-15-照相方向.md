---
layout: post
title: 照相方向
date: 2021-11-15
Author: aixz
categories:
tags: [笔记, Android,Camera2]
comments: true 
---

### Android 照相方向说明

前置摄像头的坐标系相对于竖屏手机坐标系逆时针旋转了90度，拍摄的image展示的时候就逆时针旋转了270度

后置摄像头的坐标系相对于竖屏手机坐标系顺时针旋转了90度，拍摄的image展示的时候就逆时针旋转了90度

​	

前置摄像头：<img src="https://raw.githubusercontent.com/aixz/aiboke/gh-pages/images/front_portrait.png" alt="front_portrait" style="zoom:23%;" />后置摄像头：<img src="https://raw.githubusercontent.com/aixz/aiboke/gh-pages/images/image_backfront.png" alt="front_portrait" style="zoom:23%;" />

​	前置摄像头预览是承镜像关系的。

​	因为摄像头坐标系与设备是固定关系的，当旋转设备时，相应的摄像头坐标系也相应旋转。例如：

使用后置摄像头，设备逆时针旋转90度，即设备横屏拍摄，则摄像头坐标系也逆时针旋转90度，刚好与设备的坐标系一致，

所以拍摄的图片不需要旋转就可以得到正常位置的图片。

>

```
val image = imageReader.acquireNextImage()
val buffer = image.planes[0].buffer
val bytes = ByteArray(buffer.remaining())
buffer.get(bytes)
val displayRotation: Int = windowManager.defaultDisplay.rotation
val degree = ORIENTATIONS[displayRotation]
val matrix = Matrix()
	.apply {
		postRotate(degree.toFloat())
	}
var bitmap = BitmapFactory.decodeByteArray(bytes,0,bytes.size)
bitmap = Bitmap.createBitmap(bitmap,0,0, bitmap.width ,bitmap.height,matrix,false)
```



